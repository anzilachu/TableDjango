{% extends 'base.html' %}
{% load static %}
{% block title %}
FO-121 Cannabinoids Sample Prep Log Sheet
{% endblock %}
{% block Content %}
FO-121 Cannabinoids Sample Prep Log Sheet
{% endblock %}
{% block body %}

    <hr style="margin-top: 60px;"></hr>


     <div class="" style="margin:10px;width: 100%;">
      
       
   <!-------------Filter Elements--------------------------------------->   

    <form class="search-form" action="" method="POST">
      {% csrf_token %}
    <div class="" style="float: left;">
      
      <label for="gsearch">Work Group ID :</label>
      <input class="search-input" type="" id="gsearch" name="gsearch"><br>
      <button class="white-button"><i class="fa fa-filter"></i> Filter </button>
      <button class="search-reset"><i class="fa fa-refresh"></i><a href="" style="color: white;"> Refresh </a></button>
      </div>
   
    </form>
    <!-------------------------------------------------------------------------------->
    <div>

     <!-------------------------------------------------------------------------------->

     <!-- Buttons For Add New Sample and Download Excel.  -->

     <form class="search-form" style="border-color: gray; " action="" method="POST">
      {% csrf_token %}
        <div class="" style="float: left; width: 590px;">

            <label for="gsearch">Written by: </label>          
          <input class="search-input" size="49" style="border-color: gray;" type="" id="gsearch" name="gsearch"><br>
          <label for="gsearch">Reviewed by:</label>            
          <input class="search-input" size="46" style="border-color: gray;" type="" id="gsearch" name="gsearch"><br>
          <label for="gsearch"> Approved by:</label>             
          <input class="search-input" size="46" style="border-color: gray;" type="" id="gsearch" name="gsearch"><br>
      
        </div>

          <div class="" style="float: right; width: 300px;    ">
            <label for="gsearch">Date implemented: </label> 
            <input class="search-input" style="border-color: gray;" type="date" id="datePicker" name="gsearch"><br>
            <script>
                document.getElementById('datePicker').valueAsDate = new Date();
                        </script>
          </div>

    
        </form><br>


     <form class="search-form" style="border-color: gray;" action="" method="POST">
      {% csrf_token %}
        <div class="" style="float: left; width: 520px;">
            <label for="gsearch">Analysis Type: </label>          
          <input class="search-input" style="border-color: gray;" size="30" type="" value="Cannabinoid Analysis" id="gsearch" name="gsearch"><br>

          <label for="gsearch">Date: </label> 
          <input class="search-input" style="border-color: gray; color: grey;"  type="date" id="gsearch" name="gsearch"><br>

          <label for="gsearch"> WG #:</label>             
          <input class="search-input" style="border-color: gray;" type="" size="38" id="gsearch" name="gsearch"><br>
      
        </div>

          <div class="" style="float: right;     width: 370px;">
            <label for="gsearch">Prep:</label>            
          <input class="search-input" style="border-color: gray;" size="33" type="" id="gsearch" name="gsearch"><br>
          <label for="gsearch">Dilution:</label>            
          <input class="search-input" style="border-color: gray;" size="30" type="" id="gsearch" name="gsearch"><br>
          <label for="gsearch">Analysis:</label>            
          <input class="search-input" style="border-color: gray;" size="29" type="" id="gsearch" name="gsearch"><br>

          </div>

    
        </form><br><br><br><br><br><br><br><br><br>
   <!--  <input class="search-reset" type="submit" value="Add sample"></input>
      <input class="search-reset" type="submit" value="Download Excel"></input> -->

  <!-------------------------------------------------------------------------------->
  </div>

  <!--------------------Table Data starts Here-------------------------------------------->






<table id="example" method="POST" >
  {% csrf_token %}

    </table>
 <button  class="save-button" id="save-data-button" ><i class="fa fa-save" ></i><a href="" style="color: white;"> Save Data </a></button>
    <!------------------------------End of Table Data------------------------------------------>
</div>

    </section>



    <!-- Link JS -->
    <script src="assets/js/main.js"></script>
</body>
<script>
    const container = document.querySelector('#example');

const hot = new Handsontable(container, {
  data: [
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', 'Methanol', '5ml', 'N/A', '', ''],
        ['', '', '', '', '', '',''],
        ['', '', '', '', '', '',''],
        ['LCS', '', 'Methanol', '5ml','500 ul of 250ppm std stock', '500 ul of 250 ppm std stock + 4.5ml of MeOH', ''],
        ['MB', '', 'Methanol', '5ml', 'N/A', '', ''],

  ],
  rowHeaders: ['1', '2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','Duplicate','','','LCS','MB'],
  colHeaders: ['Sample ID', 'Weight (g)', 'Solvent', 'Solvent Vol (ml)', 'Spike vol (ul)','Notes','Analysis Dilution'],
//   width: '100%',
  rowHeaderWidth: 70,
  rowHeights: 40,
  colWidths: [220, 100, 150,120,120, 400, 200],
  className: 'htCenter htMiddle',


  licenseKey: ''
});
</script>
<script>
  const saveDataButton = document.getElementById('save-data-button');

  saveDataButton.addEventListener('click', () => {
      const capturedData = hot.getData();
      fetch('/Cannibanoidssamplepreplogsheet/', {
          method: 'POST',
          headers: {
              'Content-Type': 'application/json',
              'X-CSRFToken': '{{ csrf_token }}'
          },
          body: JSON.stringify(capturedData)
      })
      .then(response => response.json())
      .then(data => {
          if (data.success) {
              alert('Data saved successfully');
          } else {
              alert('Error saving data');
          }
      })
      .catch(error => {
          console.error('Error sending data to Django:', error);
      });
  });
</script>
{% endblock %}